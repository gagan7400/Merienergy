// navbar code start 
const menuIcon = document.querySelector('.menu-icon');
const menuIconImg = document.querySelector('.menu-icon img');
const mobileMenu = document.querySelector('.mobile-menu');
const closeIcon = document.querySelector('.close-icon');
const collapsibles = document.querySelectorAll('.collapsible');
const navbar = document.querySelector('.nav-bar');
const contactnavbar = document.querySelector('.nav-bar.contact_nav');
const logo = document.getElementById('logo');
const navdropicon_battery = document.querySelector('.batteries .nav-dropicon');
const navdropicon_inverter = document.querySelector('.inverters .nav-dropicon');
const batteryDropdown = document.querySelector('.wide-dropdown.batterydropdown');
const inverterDropdown = document.querySelector('.wide-dropdown.inverterdropdown');
let drop = document.querySelectorAll(".nav-bar .wide-dropdown");
let dropopen = false;


document.addEventListener('DOMContentLoaded', function () {
    const batteryToggle = document.querySelector('.nav-link.batteries');
    const inverterToggle = document.querySelector('.nav-link.inverters');

    // Toggle Battery Dropdown
    batteryToggle.addEventListener('click', function (e) {
        e.stopPropagation();
        const isActive = batteryDropdown.classList.contains('active');

        // Close both first
        closeAllDropdowns();

        if (!isActive) {
            dropopen = true
            batteryDropdown.classList.add('active');
            navdropicon_battery.style.rotate = "180deg"
            navbar.style.background = "white"
            navbar.classList.add("scrolled")
            drop[0].style.top = "70px"
            drop[1].style.top = "70px"
            if (logo) {
                logo.src = './assets/imgs/nav_logo.png'; // Change logo
            }
        }
    });

    // Toggle Inverter Dropdown
    inverterToggle.addEventListener('click', function (e) {
        e.stopPropagation();
        const isActive = inverterDropdown.classList.contains('active');

        // Close both first
        closeAllDropdowns();

        if (!isActive) {
            dropopen = true
            inverterDropdown.classList.add('active');
            navdropicon_inverter.style.rotate = "180deg"
            navbar.style.background = "white"
            navbar.classList.add("scrolled")
            drop[0].style.top = "70px"
            drop[1].style.top = "70px"
            if (logo) {
                logo.src = './assets/imgs/nav_logo.png'; // Change logo
            }
            scrollfunction()
        }
    });

    // Close dropdowns when clicking outside
    document.addEventListener('click', function () {
        closeAllDropdowns();
    });

    function closeAllDropdowns() {
        dropopen = false
        batteryDropdown.classList.remove('active');
        inverterDropdown.classList.remove('active');
        navdropicon_battery.style.rotate = "0deg"
        navdropicon_inverter.style.rotate = "0deg"
        navbar.classList.remove("scrolled")
        navbar.setAttribute("style", "")
        drop[0].style.top = "100px"
        drop[1].style.top = "100px"
        if (logo) {
            logo.src = './assets/imgs/logo_nav.png'; // Change logo
        }
        scrollfunction()
    }
});
window.addEventListener("load", () => {

    if (window.scrollY > 100) {
        navbar.classList.add('scrolled');
        contactnavbar.setAttribute("style", "")
        menuIconImg.style.filter = "invert(1)";
        if (mobileMenu.classList.contains('active')) {
            navbar.style.background = "transparent"
            navbar.style.backdropFilter = "none"

        }
        drop[0].style.top = "70px"
        drop[1].style.top = "70px"
        if (logo) {
            logo.src = './assets/imgs/nav_logo.png'; // Change logo
        }
    } else {
        if (!dropopen) {
            navbar.classList.remove('scrolled');
            menuIconImg.style.filter = "invert(0)";
            navbar.setAttribute("style", "")
            navbar.style.background = "transparent"
            contactnavbar.style.background = "transparent"
            contactnavbar.style.backdropFilter = "none"

            drop[0].style.top = "100px"
            drop[1].style.top = "100px"
            if (logo) {
                logo.src = './assets/imgs/logo_nav.png'; // Change logo
            }
        }
    }
})
let scrollfunction = () => {
    if (window.scrollY > 100) {
        navbar.classList.add('scrolled');
        menuIconImg.style.filter = "invert(1)";
        if (mobileMenu.classList.contains('active')) {
            navbar.style.background = "transparent"
            navbar.style.backdropFilter = "none"
            contactnavbar.setAttribute("style", "")
        }
        // drop[0].style.top = "70px"
        // drop[1].style.top = "70px"
        if (logo) {
            logo.src = './assets/imgs/nav_logo.png'; // Change logo
        }
    } else {
        if (!dropopen) {
            navbar.classList.remove('scrolled');
            menuIconImg.style.filter = "invert(0)";
            navbar.setAttribute("style", "")
            contactnavbar.style.background = "transparent"
            contactnavbar.style.backdropFilter = "none"
            // drop[0].style.top = "100px"
            // drop[1].style.top = "100px"
            if (logo) {
                logo.src = './assets/imgs/logo_nav.png'; // Change logo
            }
        }
    }
};
window.addEventListener('scroll', scrollfunction);

menuIcon.addEventListener('click', () => {
    mobileMenu.classList.add('active');
});

closeIcon.addEventListener('click', () => {
    mobileMenu.classList.remove('active');
});

// Close menu on window resize if greater than 991px
window.addEventListener('resize', () => {
    if (window.innerWidth > 991) {
        mobileMenu.classList.remove('active');
    }
});

// Toggle collapsible menus (only one open at a time)
collapsibles.forEach(item => {
    const header = item.querySelector('.collapsible-header');
    const icon = header ? header.querySelector('.icon-drop') : null;

    if (header) {
        header.addEventListener('click', () => {
            // Close all others first
            collapsibles.forEach(other => {
                if (other !== item) {
                    other.classList.remove('open');
                    const otherIcon = other.querySelector('.collapsible-header>img');
                    if (otherIcon) {
                        otherIcon.src = './assets/icons/down.svg';
                    }
                }
            });

            // Toggle current one
            item.classList.toggle('open');

            if (item.classList.contains('open')) {
                if (icon) icon.src = './assets/icons/down.svg';
            } else {
                if (icon) icon.src = './assets/icons/down.svg';
            }
        });
    }
});
// navbar code end

// slider code start
$(document).ready(function () {
    // Initialize carousel
    $(".product-slider").owlCarousel({
        items: 1,
        loop: true,
        nav: true,
        dots: false,
        autoplay: true,
        autoplayTimeout: 3777000,
        navText: [
            "<span class='owl-prev-custom'><img src='./assets/icons/chevron-left.svg'/></span>",
            "<span class='owl-next-custom'><img src='./assets/icons/chevron-right.svg'/></span>"
        ]
    });

    // Tabs switching
    $(".tab-btn").click(function () {
        $(".tab-btn").removeClass("active");
        $(this).addClass("active");

        $(".tab-content").addClass("d-none").removeClass("active");
        $($(this).data("target")).removeClass("d-none").addClass("active");
    });
});
$(document).ready(function () {
    $(".testimonial-section .owl-carousel").owlCarousel({
        loop: true,
        margin: 20,
        nav: true,
        dots: false,
        navText: [
            "<span class='owl-prev-custom'><img src='./assets/icons/chevron-left.svg'/></span>",
            "<span class='owl-next-custom'><img src='./assets/icons/chevron-right.svg'/></span>"
        ],   // customize arrow icons
        responsive: {
            0: { items: 1 },    // 1 card on mobile
            768: { items: 2 },  // 2 cards on tablets
            992: { items: 3 }   // 3 cards on desktops
        }
    });

});
$('.blog_slider .owl-carousel').owlCarousel({
    loop: true,
    margin: 20,
    nav: true,
    center: true,
    items: 1,
    stagePadding: ($(window).width() * 0.15), // 15% each side for half cards
    responsive: {
        0: {
            items: 1,
            stagePadding: 50
        },
        768: {
            items: 1,
            stagePadding: $(window).width() * 0.1
        },
        1200: {
            items: 1,
            stagePadding: $(window).width() * 0.15
        }
    },
    navText: [
        "<span class='owl-prev-custom'><img src='./assets/icons/chevron-left.svg'/></span>",
        "<span class='owl-next-custom'><img src='./assets/icons/chevron-right.svg'/></span>"
    ],
});

// slider code end
